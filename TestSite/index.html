<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cricket Nets Duel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: Arial, sans-serif;
        background: radial-gradient(circle at top, #003300 0%, #000000 55%, #000000 100%);
        color: #eaffff;
    }

    #app {
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        padding: 10px;
    }

    h1 {
        font-size: 7vw;
        color: #00eaff;
        text-shadow: 0 0 12px #00eaff, 0 0 25px #00eaff;
        margin: 5px 0 15px 0;
        text-align: center;
    }

    .screen {
        width: 100%;
        max-width: 480px;
        box-sizing: border-box;
    }

    .hidden {
        display: none;
    }

    .sectionLabel {
        font-size: 4.5vw;
        color: #88ff88;
        text-shadow: 0 0 8px #00ff55;
        margin: 10px 0 5px 0;
        text-align: center;
    }

    .pillBtn, .btn {
        border: none;
        cursor: pointer;
        transition: 0.15s;
        color: white;
        background: #111;
        box-shadow: 0 0 12px #00eaff inset, 0 0 12px #00eaff;
        border-radius: 999px;
        padding: 10px 16px;
        font-size: 4.2vw;
        width: 100%;
        margin-top: 10px;
    }

    .btn {
        border-radius: 10px;
        font-size: 4vw;
    }

    .pillBtn:active, .btn:active {
        transform: scale(0.97);
        box-shadow: 0 0 18px #00eaff inset, 0 0 22px #00eaff;
    }

    .inputRow {
        display: flex;
        gap: 8px;
        margin: 5px 0;
    }

    .inputRow input {
        flex: 1;
        padding: 8px;
        border-radius: 8px;
        border: 1px solid #00eaff;
        background: #020b0b;
        color: #eaffff;
        font-size: 4vw;
        box-shadow: 0 0 6px #003344 inset;
    }

    .smallLabel {
        font-size: 3.4vw;
        opacity: 0.8;
        margin-top: 4px;
    }

    /* GAME AREA */

    #gameAreaWrapper {
        width: 100%;
        max-width: 480px;
        aspect-ratio: 9 / 16;
        position: relative;
        border-radius: 20px;
        background: linear-gradient(to bottom, #001a00 0%, #000000 100%);
        box-shadow: 0 0 18px #00eaff;
        overflow: hidden;
        margin: 0 auto;
    }

    #gameArea {
        position: absolute;
        inset: 0;
    }

    .zone {
        position: absolute;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(255,255,255,0.3);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3vw;
        text-align: center;
        color: #000;
        font-weight: bold;
        user-select: none;
    }

    /* Base colours */
    .zone.yellow {
        background: #ffe066;
        box-shadow: 0 0 12px #ffe066;
    }

    .zone.blue {
        background: #4da6ff;
        box-shadow: 0 0 12px #4da6ff;
    }

    /* Multiplier (green) */
    .zone.multiplier {
        background: #4dff88 !important;
        box-shadow: 0 0 16px #4dff88;
        border: 2px solid #ffffff;
    }

    /* Danger (red) */
    .zone.danger {
        background: #ff4d4d !important;
        box-shadow: 0 0 16px #ff4d4d;
        border: 2px solid #ffffff;
    }

    .zone.flash {
        animation: flash 0.25s ease-out;
    }

    @keyframes flash {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(0.96); opacity: 0.7; }
        100% { transform: scale(1); opacity: 1; }
    }

    /* Layout of zones (phone as nets) */

    /* Top two slender rectangles (behind stumps) */
    #zoneTopOff {
        top: 2%;
        left: 5%;
        width: 42%;
        height: 8%;
    }
    #zoneTopLeg {
        top: 2%;
        right: 5%;
        width: 42%;
        height: 8%;
    }

    /* Left side – 3 zones */
    #zoneLeft1 {
        top: 14%;
        left: 2%;
        width: 18%;
        height: 18%;
    }
    #zoneLeft2 {
        top: 34%;
        left: 2%;
        width: 18%;
        height: 18%;
    }
    #zoneLeft3 {
        top: 54%;
        left: 2%;
        width: 18%;
        height: 18%;
    }

    /* Right side – 3 zones */
    #zoneRight1 {
        top: 14%;
        right: 2%;
        width: 18%;
        height: 18%;
    }
    #zoneRight2 {
        top: 34%;
        right: 2%;
        width: 18%;
        height: 18%;
    }
    #zoneRight3 {
        top: 54%;
        right: 2%;
        width: 18%;
        height: 18%;
    }

    /* Bottom – one big rectangle (in front) */
    #zoneBottom {
        bottom: 3%;
        left: 10%;
        width: 80%;
        height: 14%;
    }

    /* Info panel in the middle */
    #infoPanel {
        position: absolute;
        top: 20%;
        left: 22%;
        width: 56%;
        height: 50%;
        border-radius: 16px;
        background: rgba(0, 0, 0, 0.75);
        box-shadow: 0 0 14px #003344 inset;
        padding: 10px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        color: #eaffff;
        text-align: center;
    }

    #infoPlayer {
        font-size: 4.2vw;
        color: #00eaff;
        text-shadow: 0 0 8px #00eaff;
    }

    #infoBalls, #infoScore {
        font-size: 3.6vw;
        margin-top: 4px;
    }

    #infoLast {
        font-size: 3.4vw;
        margin-top: 8px;
        line-height: 1.4;
    }

    #softHardHint {
        font-size: 3.2vw;
        opacity: 0.8;
        margin-top: 6px;
    }

    #multiplierInfo {
        font-size: 3.2vw;
        margin-top: 4px;
        color: #4dff88;
    }

    #dangerInfo {
        font-size: 3.2vw;
        margin-top: 2px;
        color: #ff4d4d;
    }

    #nextPlayerBtn {
        margin-top: 8px;
        font-size: 3.4vw;
        padding: 6px 10px;
    }

    #scoreLog {
        margin-top: 10px;
        font-size: 3.4vw;
        max-height: 20vh;
        overflow-y: auto;
    }

    #scoreLog div {
        margin-bottom: 4px;
    }

    #controlsRow {
        display: flex;
        gap: 8px;
        margin-top: 8px;
    }

    #voiceToggleBtn {
        font-size: 3.4vw;
        padding: 6px 10px;
    }

    #wideBtn {
        font-size: 3.4vw;
        padding: 6px 10px;
        background: #444;
        box-shadow: 0 0 10px #ffffff44;
    }

    /* RULES MODAL */
    #rulesModalOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 999;
    }

    #rulesModal {
        width: 90%;
        max-width: 480px;
        background: #020b0b;
        border-radius: 16px;
        box-shadow: 0 0 18px #00eaff;
        padding: 16px;
        box-sizing: border-box;
        color: #eaffff;
    }

    #rulesModal h2 {
        margin-top: 0;
        font-size: 5vw;
        color: #00eaff;
        text-align: center;
    }

    #rulesModal p, #rulesModal li {
        font-size: 3.4vw;
        line-height: 1.4;
    }

    #rulesModal ul {
        padding-left: 18px;
    }

    #closeRulesBtn {
        margin-top: 10px;
        width: 100%;
        font-size: 4vw;
    }
</style>
</head>
<body>

<div id="app">
    <h1>Crcket Nets Duel</h1>

    <!-- RULES MODAL -->
    <div id="rulesModalOverlay">
        <div id="rulesModal">
            <h2>How to Play</h2>
            <p><strong>What you need:</strong></p>
            <ul>
                <li>3 or more players (batter, bowler, scorer).</li>
                <li>4 objects to divide the nets (cones, bottles, rocks, etc.).</li>
                <li>A phone with this game open.</li>
            </ul>
            <p><strong>Setup:</strong></p>
            <ul>
                <li>Use the 4 markers to split the side nets into 6 lanes.</li>
                <li>Behind the stumps is split into off side and leg side.</li>
                <li>In front of the batter is the straight zone.</li>
            </ul>
            <p><strong>How a turn works:</strong></p>
            <ul>
                <li>Each player gets a set number of balls (e.g. 30).</li>
                <li>One player bats, one bowls, one scores.</li>
                <li>After each ball, the scorer taps where the ball went on the phone.</li>
                <li>Choose soft or hard shot when asked.</li>
            </ul>
            <p><strong>Special zones:</strong></p>
            <ul>
                <li><span style="color:#4dff88;">Green zone</span> = double runs (bonus).</li>
                <li><span style="color:#ff4d4d;">Red zone</span> = danger zone (automatic out).</li>
            </ul>
            <p><strong>Extras:</strong></p>
            <ul>
                <li>If it's a wide, tap the "Wide +1" button. Add 1 run, no ball lost.</li>
                <li>Wickets (run outs / catches) can also happen on some shots.</li>
            </ul>
            <p>Rotate roles so everyone gets to bat, bowl, and score. Highest total wins!</p>
            <button id="closeRulesBtn" class="btn" onclick="closeRules()">Close</button>
        </div>
    </div>

    <!-- SETUP SCREEN -->
    <div id="setupScreen" class="screen">
        <div class="sectionLabel">Players</div>
        <div class="smallLabel" style="text-align:center;">
            Enter 2 or more names. Rotate roles in real life.
        </div>

        <div class="inputRow">
            <input id="p1" placeholder="Player 1">
        </div>
        <div class="inputRow">
            <input id="p2" placeholder="Player 2">
        </div>
        <div class="inputRow">
            <input id="p3" placeholder="Player 3 (optional)">
        </div>
        <div class="inputRow">
            <input id="p4" placeholder="Player 4 (optional)">
        </div>
        <div class="inputRow">
            <input id="p5" placeholder="Player 5 (optional)">
        </div>

        <div class="sectionLabel">Balls per player</div>
        <div class="inputRow">
            <input id="ballsInput" type="number" min="6" max="60" value="30">
        </div>
        <div class="smallLabel" style="text-align:center;">
            Default is 30 balls each.
        </div>

        <button class="pillBtn" onclick="startGame()">Start Nets Duel</button>
        <button class="btn" style="margin-top:8px;" onclick="openRules()">Rules</button>
    </div>

    <!-- GAME SCREEN -->
    <div id="gameScreen" class="screen hidden">
        <div id="gameAreaWrapper">
            <div id="gameArea">
                <!-- Zones -->
                <div id="zoneTopOff" class="zone yellow" data-zone="topOff">OFF BACK</div>
                <div id="zoneTopLeg" class="zone blue" data-zone="topLeg">LEG BACK</div>

                <div id="zoneLeft1" class="zone blue" data-zone="left1">OFF 1</div>
                <div id="zoneLeft2" class="zone yellow" data-zone="left2">OFF 2</div>
                <div id="zoneLeft3" class="zone blue" data-zone="left3">OFF 3</div>

                <div id="zoneRight1" class="zone yellow" data-zone="right1">LEG 1</div>
                <div id="zoneRight2" class="zone blue" data-zone="right2">LEG 2</div>
                <div id="zoneRight3" class="zone yellow" data-zone="right3">LEG 3</div>

                <div id="zoneBottom" class="zone blue" data-zone="bottom">STRAIGHT</div>

                <!-- Info panel -->
                <div id="infoPanel">
                    <div id="infoPlayer">Player</div>
                    <div id="infoBalls">Balls: 30</div>
                    <div id="infoScore">Score: 0</div>
                    <div id="infoLast">Tap where the ball went.</div>
                    <div id="softHardHint">
                        After tapping a zone, choose soft or hard shot.
                    </div>
                    <div id="multiplierInfo"></div>
                    <div id="dangerInfo"></div>
                    <button id="nextPlayerBtn" class="btn" onclick="nextPlayer()" style="display:none;">
                        Next Player
                    </button>
                </div>
            </div>
        </div>

        <div id="controlsRow">
            <button id="voiceToggleBtn" class="btn" onclick="toggleVoice()">Voice: ON</button>
            <button id="wideBtn" class="btn" onclick="addWide()">Wide +1</button>
        </div>

        <div id="scoreLog"></div>
    </div>
</div>

<script>
/* STATE */
let players = [];
let currentPlayerIndex = 0;
let ballsPerPlayer = 30;
let ballsLeft = 0;
let currentScore = 0;

let voiceOn = true;
let multiplierZoneId = null;
let dangerZoneId = null;

/* SPEECH SYNTHESIS */
function speak(text) {
    if (!voiceOn) return;
    if (!("speechSynthesis" in window)) return;

    const utter = new SpeechSynthesisUtterance(text);
    utter.rate = 1;
    utter.pitch = 1;
    utter.volume = 1;

    const voices = speechSynthesis.getVoices();
    const preferred = voices.find(v =>
        v.name.toLowerCase().includes("english") ||
        v.name.toLowerCase().includes("child") ||
        v.name.toLowerCase().includes("male")
    );
    if (preferred) utter.voice = preferred;

    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
}

function toggleVoice() {
    voiceOn = !voiceOn;
    document.getElementById("voiceToggleBtn").innerText = voiceOn ? "Voice: ON" : "Voice: OFF";
}

/* RULES MODAL */
function openRules() {
    document.getElementById("rulesModalOverlay").style.display = "flex";
}
function closeRules() {
    document.getElementById("rulesModalOverlay").style.display = "none";
}

/* START GAME */
function startGame() {
    const names = [
        document.getElementById("p1").value.trim() || "Player 1",
        document.getElementById("p2").value.trim(),
        document.getElementById("p3").value.trim(),
        document.getElementById("p4").value.trim(),
        document.getElementById("p5").value.trim()
    ].filter(n => n && n.length > 0);

    if (names.length < 2) {
        alert("Please enter at least 2 player names.");
        return;
    }

    players = names;
    const ballsInput = parseInt(document.getElementById("ballsInput").value, 10);
    ballsPerPlayer = (!isNaN(ballsInput) && ballsInput > 0) ? ballsInput : 30;

    document.getElementById("setupScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");

    currentPlayerIndex = 0;
    startPlayerTurn();
}

/* START TURN FOR CURRENT PLAYER */
function startPlayerTurn() {
    ballsLeft = ballsPerPlayer;
    currentScore = 0;
    updateInfoPanel("Tap where the ball went.");
    document.getElementById("nextPlayerBtn").style.display = "none";
    document.getElementById("scoreLog").scrollTop = document.getElementById("scoreLog").scrollHeight;
    setNewSpecialZones();
}

/* UPDATE INFO PANEL */
function updateInfoPanel(lastText) {
    const playerName = players[currentPlayerIndex];
    document.getElementById("infoPlayer").innerText = playerName;
    document.getElementById("infoBalls").innerText = "Balls: " + ballsLeft;
    document.getElementById("infoScore").innerText = "Score: " + currentScore;
    if (lastText) {
        document.getElementById("infoLast").innerText = lastText;
        speak(lastText);
    }
}

/* SPECIAL ZONES: MULTIPLIER + DANGER */
function setNewSpecialZones() {
    const zones = Array.from(document.querySelectorAll(".zone"));
    zones.forEach(z => {
        z.classList.remove("multiplier");
        z.classList.remove("danger");
    });

    const ids = zones.map(z => z.id);
    if (ids.length < 2) return;

    const multiplierIndex = Math.floor(Math.random() * ids.length);
    let dangerIndex = Math.floor(Math.random() * ids.length);
    while (dangerIndex === multiplierIndex) {
        dangerIndex = Math.floor(Math.random() * ids.length);
    }

    multiplierZoneId = ids[multiplierIndex];
    dangerZoneId = ids[dangerIndex];

    const multZone = document.getElementById(multiplierZoneId);
    const dangerZone = document.getElementById(dangerZoneId);

    if (multZone) multZone.classList.add("multiplier");
    if (dangerZone) dangerZone.classList.add("danger");

    const multLabel = multZone ? multZone.innerText : "";
    const dangerLabel = dangerZone ? dangerZone.innerText : "";

    document.getElementById("multiplierInfo").innerText =
        "Green zone (double runs): " + multLabel;
    document.getElementById("dangerInfo").innerText =
        "Red zone (danger out): " + dangerLabel;
}

/* ZONE CLICK HANDLER */
document.querySelectorAll(".zone").forEach(zone => {
    zone.addEventListener("click", () => {
        if (ballsLeft <= 0) return;

        const zoneKey = zone.getAttribute("data-zone");

        const isHard = confirm("Hard shot? (OK = Hard, Cancel = Soft)");

        let outcome = getOutcome(zoneKey, isHard);

        const zoneId = zone.id;
        const isDanger = (zoneId === dangerZoneId);
        const isMultiplier = (zoneId === multiplierZoneId);

        if (isDanger) {
            outcome.runs = 0;
            outcome.text = players[currentPlayerIndex] +
                " hits it straight to the fielder in the danger zone. OUT!";
        } else {
            if (isMultiplier && outcome.runs > 0) {
                outcome.runs *= 2;
                outcome.text += " Power zone! Runs doubled.";
            }

            const wicketRoll = Math.random();
            if (!isDanger) {
                if (!isHard && wicketRoll < 0.05) {
                    outcome.runs = 0;
                    outcome.text = players[currentPlayerIndex] +
                        " hesitates… run out chance… OUT!";
                } else if (isHard && wicketRoll < 0.08) {
                    outcome.runs = 0;
                    outcome.text = players[currentPlayerIndex] +
                        " goes big… but it's caught on the boundary! OUT!";
                }
            }
        }

        currentScore += outcome.runs;
        ballsLeft--;

        zone.classList.add("flash");
        setTimeout(() => zone.classList.remove("flash"), 200);

        updateInfoPanel(outcome.text);

        if (ballsLeft <= 0) {
            endPlayerTurn();
        } else {
            setNewSpecialZones();
        }
    });
});

/* OUTCOME LOGIC */
function getOutcome(zoneKey, isHard) {
    let runs = 0;
    let text = "";

    const playerName = players[currentPlayerIndex];

    switch (zoneKey) {
        case "topOff":
            runs = isHard ? 4 : 1;
            text = isHard
                ? playerName + " lifts it over the keeper for 4!"
                : playerName + " dabs it fine on the off side for 1.";
            break;
        case "topLeg":
            runs = isHard ? 4 : 1;
            text = isHard
                ? playerName + " performs a ramp shot past fine leg for 4!"
                : playerName + " glances it down leg for a single.";
            break;
        case "left1":
            runs = isHard ? 6 : 2;
            text = isHard
                ? playerName + " launches a big cut shot for 6!"
                : playerName + " nudges it behind point for 2.";
            break;
        case "left2":
            runs = isHard ? 4 : 2;
            text = isHard
                ? playerName + " whips it through mid-off for 4!"
                : playerName + " works it into the covers for 2.";
            break;
        case "left3":
            runs = isHard ? 3 : 1;
            text = isHard
                ? playerName + " drives it past long off for 3."
                : playerName + " tucks it off the pads for 1.";
            break;
        case "right1":
            runs = isHard ? 6 : 2;
            text = isHard
                ? playerName + " hooks it over square leg for 6!"
                : playerName + " guides it in front of fine leg for 2.";
            break;
        case "right2":
            runs = isHard ? 4 : 2;
            text = isHard
                ? playerName + " drives square through mid wicket for 4!"
                : playerName + " pushes it towards cow corner for 2.";
            break;
        case "right3":
            runs = isHard ? 3 : 1;
            text = isHard
                ? playerName + " carves it out to deep mid-wicket for 3."
                : playerName + " steers it to mid on for a single.";
            break;
        case "bottom":
            runs = isHard ? 4 : 1;
            text = isHard
                ? playerName + " smashes a straight drive for 4!"
                : playerName + " blocks it back down the pitch for 1.";
            break;
        default:
            runs = 0;
            text = playerName + " lets it go. No run.";
    }

    return { runs, text };
}

/* WIDE BUTTON */
function addWide() {
    if (ballsLeft <= 0) return;
    currentScore += 1;
    updateInfoPanel("Wide ball. +1 run, no ball lost.");
}

/* END OF PLAYER TURN */
function endPlayerTurn() {
    const playerName = players[currentPlayerIndex];
    const log = document.getElementById("scoreLog");
    const entry = document.createElement("div");
    entry.innerText = playerName + " scored " + currentScore + " runs (" + ballsPerPlayer + " balls).";
    log.appendChild(entry);

    updateInfoPanel(playerName + "'s turn is over.");

    if (currentPlayerIndex < players.length - 1) {
        document.getElementById("nextPlayerBtn").style.display = "block";
    } else {
        document.getElementById("nextPlayerBtn").style.display = "none";
        const finalMsg = document.createElement("div");
        finalMsg.style.marginTop = "6px";
        finalMsg.innerText = "All players have finished. Play another round by refreshing.";
        log.appendChild(finalMsg);
    }

    document.getElementById("scoreLog").scrollTop = document.getElementById("scoreLog").scrollHeight;
}

/* NEXT PLAYER */
function nextPlayer() {
    if (currentPlayerIndex >= players.length - 1) return;
    currentPlayerIndex++;
    startPlayerTurn();
}
</script>

</body>
</html>




